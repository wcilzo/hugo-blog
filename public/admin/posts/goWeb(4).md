---
title: Gee微框架学习记录(第四天)
date: 2025-04-07T10:50:30+08:00
lastmod: 2025-04-07T10:50:30+08:00
author: xiestr
avatar: /img/author.jpg
avatar: ../../img/avatar.jpg
# authorlink: https://author.site
# cover: /img/cover.jpg
# images:
#   - /img/cover.jpg
categories:
  - GoWeb
tags:
  - GoWeb
# nolastmod: true
draft: true
---

对7天系列中Gee框架学习的记录。推荐和Gee第四天一起食用。

> [!NOTE]
>
> 前面完成了动态路由的相关配置，Gee第四天主要讨论分组路由实现，第五天的中间件处理需要用到，所以这一节要理解。

**1. 什么是分组路由？**

想象你管理一家超市：

- **没分组**：就像把零食、日用品、生鲜全混在一起，想给所有零食打折时，得一个个商品去贴标签，累死人还容易漏。
- **分组后**：把商品分到不同货架（零食区、日用品区）。想给零食打折？直接在零食区挂个"全场8折"的牌子，简单又不会搞错。

在动态路由系统中，当需要**批量管理路由行为**（如中间件应用、路径前缀统一调整）时，通过个体路由白名单维护会导致：

- **修改成本高**：变更中间件需逐个路由调整
- **一致性风险**：易遗漏部分路由配置

- **可维护性差**：路由与业务逻辑关联不直观



**分组嵌套路由**

指的是路由分组可以包含子分组，也就是分组再分组。形成**多级路由前缀**和**中间件继承链**。每个子分组自动继承父分组的所有属性（路径前缀、中间件），并允许扩展自己的特定配置。

那么在这里应该如何实现呢？

为了能够匹配路由前缀和继承父分组的路由前缀、中间件。通过父分组很容易想到需要一个类似树结构的数据结构。在前面的动态路由中，额外定义了一个Trie树并交给Router进行管理。这里我们也可以用类似的操作，定义一个新的结构体Group，给Engine进行管理。

Group对象应该包含前缀prefix，用于查找父节点的parent，以及中间件middlewares(下一节提到)。为了能够访问路由节点，需要加上Engine。通过Engine，Group就能够访问router。

**为什么rotuer不写在Group中？**

如果存在一些重复的前缀，需要创建不同的路由，而且路径可能会产生冲突。在进行一些特殊路由的匹配，比如说两个

```text
Tree1 (group1):
/api/v1/users

Tree2 (group2):
/admin/users
```



























